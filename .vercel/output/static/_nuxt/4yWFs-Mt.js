import{_ as E}from"./D_Ip9zNA.js";import{_ as F}from"./b2XhvBR1.js";import{_ as J}from"./DF4dXhcg.js";import{_ as O}from"./Cdgg-7JV.js";import{_ as L}from"./imMYxLiP.js";import{_ as Q}from"./Cm2tcYAv.js";import{_ as W}from"./Cs7KMubB.js";import{z as X,y as Y,m as Z,r as ee,v as ae,R as te,c as oe,b as o,w as s,B as se,o as z,a as _,g as e,t as T,h as re,i as le,d as g,k as ne}from"./BVdw5vJQ.js";import{c as ue,u as de,r as i}from"./COQxO7zj.js";import{u as C}from"./BFX_Otd8.js";import{f as H}from"./C__g2RLv.js";import"./BSNo9jaY.js";import"./0-e7FVdg.js";import"./p7QnFScQ.js";import"./C3LguLNo.js";import"./Bm92f-5u.js";import"./CxIZtCgj.js";import"./C97eXVNd.js";import"./C0tuFO62.js";import"./DOwuRLCg.js";import"./Dq2jcSPC.js";import"./C9URDrvn.js";import"./9dOsKKNX.js";import"./BwKW8Zfl.js";import"./f51bCrOI.js";import"./D9ImkJXs.js";import"./Bish5eGS.js";import"./CCYVfaL6.js";import"./DOzJKxRB.js";import"./CovN8vff.js";const ie={class:"space-y-4 mt-4"},ce={class:"text-sm text-black/55"},me={class:"space-y-4 mt-4"},_e={class:"flex border rounded-sm divide-x"},pe={class:"grid grid-cols-2 gap-4"},be={class:"flex justify-end gap-4"},Oe={__name:"[[voucherId]]",setup(fe){const x=X(),m=Y(),k=Z();m.meta.breadcrumb=m.params.action==="add"?[{label:"Voucher Toko Saya",to:"/seller/voucher"},{label:"Buat Voucher Baru"}]:[{label:"Voucher Saya",to:"/seller/voucher"},{label:"Ubah Voucher"}];const a=ee({name:"",code:"",voucher_type:"discount",is_public:!1,discount_cashback_type:"fixed",discount_cashback_value:0,discount_cashback_max:0,start_date:null,end_date:null}),P={name:{required:i},code:{required:i},voucher_type:{required:i},is_public:{required:i},discount_cashback_type:{required:i},discount_cashback_value:{required:i,maxValue:ue.withMessage("Percentage maximal value is 100",(r,t)=>t.discount_cashback_type==="percentage"?Number(r)<=100:!0)},discount_cashback_max:{},start_date:{required:i},end_date:{required:i}},n=de(P,a,{$autoDirty:!0});ae(()=>a.value.voucher_type,r=>{r==="cashback"&&(a.value.discount_cashback_type="fixed",a.value.discount_cashback_max=0)});const{execute:I,status:$}=C("/server/api/seller-dashboard/voucher",{onResponse({response:r}){r.ok&&(x.add({color:"green",title:"Berhasil menambah voucher"}),k.push("/seller/voucher"))}}),{execute:A,status:U}=C(`/server/api/seller-dashboard/voucher/${m.params.voucherId}`,{onResponse({response:r}){r.ok&&(x.add({color:"green",title:"Berhasil mengubah voucher"}),k.push("/seller/voucher"))}});async function G(){if(!await n.value.$validate())return;const t={...a.value,is_public:a.value.is_public?1:0,start_date:a.value.start_date?H(a.value.start_date,"yyyy-MM-dd HH:mm:ss"):void 0,end_date:a.value.end_date?H(a.value.end_date,"yyyy-MM-dd HH:mm:ss"):void 0};if(m.params.voucherId&&m.params.action==="edit"){A({...t,_method:"PATCH"});return}I(t)}return te(()=>{var r;if(m.params.action==="edit"){const t=(r=k.options.history.state)==null?void 0:r.voucher;if(!t){k.replace("/seller/voucher");return}const u=JSON.parse(t);a.value={...a.value,...u,start_date:u.start_date?new Date(u.start_date):null,end_date:u.end_date?new Date(u.end_date):null}}}),(r,t)=>{const u=E,c=F,K=J,y=O,j=L,q=Q,D=W,B=ne;return z(),oe("form",{class:"space-y-5 py-5",onSubmit:se(G,["prevent"])},[o(y,{title:"Rincian Dasar"},{default:s(()=>{var p,b,f,h,v,V;return[_("div",ie,[o(c,{label:"Nama Voucher",help:"Nama Voucher tidak ditampilkan ke Pembeli",error:(b=(p=e(n).name.$errors)==null?void 0:p[0])==null?void 0:b.$message},{default:s(()=>[o(u,{modelValue:e(a).name,"onUpdate:modelValue":t[0]||(t[0]=d=>e(a).name=d),size:"lg",maxlength:"100"},{trailing:s(()=>[_("span",ce,T(`${e(a).name.length}/100`),1)]),_:1},8,["modelValue"])]),_:1},8,["error"]),o(c,{label:"Kode Voucher",error:(h=(f=e(n).code.$errors)==null?void 0:f[0])==null?void 0:h.$message},{default:s(()=>[o(u,{modelValue:e(a).code,"onUpdate:modelValue":t[1]||(t[1]=d=>e(a).code=d),size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),o(c,{label:" ",error:(V=(v=e(n).is_public.$errors)==null?void 0:v[0])==null?void 0:V.$message},{default:s(()=>[o(K,{modelValue:e(a).is_public,"onUpdate:modelValue":t[2]||(t[2]=d=>e(a).is_public=d),label:"Hanya Pelanggan Setia"},null,8,["modelValue"])]),_:1},8,["error"])])]}),_:1}),o(y,{title:"Pengaturan Bonus"},{default:s(()=>{var p,b,f,h,v,V,d,w,S,M,N,R;return[_("div",me,[o(c,{label:"Tipe Voucher",ui:{wrapper:"flex items-center gap-4",label:{wrapper:"pt-0"}},error:(b=(p=e(n).voucher_type.$errors)==null?void 0:p[0])==null?void 0:b.$message},{default:s(()=>[o(j,{modelValue:e(a).voucher_type,"onUpdate:modelValue":t[3]||(t[3]=l=>e(a).voucher_type=l),options:["discount","cashback"],ui:{fieldset:"flex gap-3"},"ui-radio":{label:"capitalize"}},null,8,["modelValue"])]),_:1},8,["error"]),o(c,{label:"Tipe Diskon | Diskon",error:((h=(f=e(n).discount_cashback_type.$errors)==null?void 0:f[0])==null?void 0:h.$message)||((V=(v=e(n).discount_cashback_value.$errors)==null?void 0:v[0])==null?void 0:V.$message)},{default:s(()=>[_("div",_e,[o(q,{modelValue:e(a).discount_cashback_type,"onUpdate:modelValue":t[4]||(t[4]=l=>e(a).discount_cashback_type=l),options:[{label:"Nominal",value:"fixed"},{label:"Diskon",value:"percentage"}],disabled:e(a).voucher_type==="cashback","value-attribute":"value","option-attribute":"label",variant:"none"},null,8,["modelValue","disabled"]),o(u,{modelValue:e(a).discount_cashback_value,"onUpdate:modelValue":t[5]||(t[5]=l=>e(a).discount_cashback_value=l),class:"flex-1",padded:!1,type:"number",variant:"none",ui:{base:"h-full"}},{leading:s(()=>[g(T(e(a).discount_cashback_type==="fixed"?"Rp":"%"),1)]),_:1},8,["modelValue"])])]),_:1},8,["error"]),e(a).discount_cashback_type!=="fixed"&&e(a).voucher_type==="discount"?(z(),re(c,{key:0,label:"Diskon/Cashback Maksimal",error:(w=(d=e(n).discount_cashback_max.$errors)==null?void 0:d[0])==null?void 0:w.$message},{default:s(()=>[o(u,{modelValue:e(a).discount_cashback_max,"onUpdate:modelValue":t[6]||(t[6]=l=>e(a).discount_cashback_max=l),size:"lg",type:"number"},{leading:s(()=>[...t[9]||(t[9]=[g(" Rp ",-1)])]),_:1},8,["modelValue"])]),_:1},8,["error"])):le("",!0),o(c,{label:"Tanggal Voucher Bisa Digunakan",error:((M=(S=e(n).start_date.$errors)==null?void 0:S[0])==null?void 0:M.$message)||((R=(N=e(n).end_date.$errors)==null?void 0:N[0])==null?void 0:R.$message)},{default:s(()=>[_("div",pe,[o(D,{modelValue:e(a).start_date,"onUpdate:modelValue":t[7]||(t[7]=l=>e(a).start_date=l)},null,8,["modelValue"]),o(D,{modelValue:e(a).end_date,"onUpdate:modelValue":t[8]||(t[8]=l=>e(a).end_date=l)},null,8,["modelValue"])])]),_:1},8,["error"])])]}),_:1}),o(y,{class:"sticky bottom-4"},{default:s(()=>[_("div",be,[o(B,{color:"white",size:"xs",disabled:e($)==="pending"||e(U)==="pending",to:"/seller/voucher"},{default:s(()=>[...t[10]||(t[10]=[g(" Kembali ",-1)])]),_:1},8,["disabled"]),o(B,{type:"submit",color:"primary",size:"xs",loading:e($)==="pending"||e(U)==="pending"},{default:s(()=>[...t[11]||(t[11]=[g(" Simpan ",-1)])]),_:1},8,["loading"])])]),_:1})],32)}}};export{Oe as default};
