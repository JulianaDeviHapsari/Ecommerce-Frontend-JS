import{_ as z}from"./D_Ip9zNA.js";import{_ as E}from"./0-e7FVdg.js";import{_ as G}from"./DW2cZgo6.js";import{C as M,l as q,r as B,c as F,b as e,w as n,A as H,o as O,a as o,d as i,B as W,g as a,k as J,e as K}from"./BVdw5vJQ.js";import{_ as Q,a as X}from"./DQEJrTrP.js";import{_ as Y}from"./p7QnFScQ.js";import{_ as Z}from"./MFBl4QUC.js";import{c as tt,e as et,u as ot,m as st,r as U}from"./COQxO7zj.js";import{u as at,a as nt}from"./DOzJKxRB.js";import{u as rt}from"./BFX_Otd8.js";import{u as it}from"./CCYVfaL6.js";import"./BSNo9jaY.js";import"./DJvw907_.js";import"./j9dIvsdS.js";import"./DE8bu4_G.js";import"./Bish5eGS.js";import"./DOwuRLCg.js";import"./C97eXVNd.js";import"./C0tuFO62.js";import"./9dOsKKNX.js";import"./Bm92f-5u.js";import"./CxIZtCgj.js";import"./BwKW8Zfl.js";const lt={class:"bg-primary"},mt={class:"text-sm font-normal text-black/25 text-center mt-8"},Pt={__name:"login",setup(ut){const S=at(),{profile:A,token:N}=M(S),T=nt("access_token"),h=q(),r=B({phone_email:"",password:""}),C={phone_email:{required:U,isValidUsername:tt.withMessage("Value is not valid",s=>s?/^\d{4}/.test(s)?/^\d+$/.test(s):et.$validator(s):!0)},password:{required:U,minLength:st(8)}},v=B({}),f=ot(C,r,{$autoDirty:!0,$externalResults:v}),{status:w,execute:L,error:k,data:x}=rt("/server/api/login"),{execute:P,status:D}=it("/server/api/profile",{immediate:!1,onResponse({response:s}){var t;s.ok&&(A.value=(t=s._data)==null?void 0:t.data,h.runWithContext(()=>{H("/")}))}});async function I(){var t,u,l,p,m,d,_,c;if(await f.value.$validate()){if(await L(r.value),k.value){v.value=((u=(t=k.value.data)==null?void 0:t.meta)==null?void 0:u.validations)||{};return}w.value==="success"&&((p=(l=x.value)==null?void 0:l.data)!=null&&p.token)&&(N.value=(d=(m=x.value)==null?void 0:m.data)==null?void 0:d.token,T.value=(c=(_=x.value)==null?void 0:_.data)==null?void 0:c.token,P())}}return(s,t)=>{const u=z,l=E,p=G,m=J,d=Q,_=X,c=K,R=Y,j=Z;return O(),F("section",lt,[e(j,{class:"grid grid-cols-2 h-full py-20"},{default:n(()=>[t[7]||(t[7]=o("div",{class:"flex justify-center items-center"},[o("div",{class:"flex flex-col gap-14 text-white text-center"},[o("h1",{class:"text-8xl"},"Syopo"),o("p",null,[i("Tempat Belanja Online No. 1"),o("br"),i("di Asia Tengara dan Taiwan")])])],-1)),o("div",null,[e(R,{class:"w-96",ui:{rounded:"rounded-sm"}},{default:n(()=>{var V,$,b,y;return[t[6]||(t[6]=o("h2",null,"Login",-1)),o("form",{class:"mt-7 space-y-7",onSubmit:W(I,["prevent"])},[e(l,{error:($=(V=a(f).phone_email.$errors)==null?void 0:V[0])==null?void 0:$.$message},{default:n(()=>[e(u,{modelValue:a(r).phone_email,"onUpdate:modelValue":t[0]||(t[0]=g=>a(r).phone_email=g),placeholder:"No. Handphone/Email",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),e(l,{error:(y=(b=a(f).password.$errors)==null?void 0:b[0])==null?void 0:y.$message},{default:n(()=>[e(p,{modelValue:a(r).password,"onUpdate:modelValue":t[1]||(t[1]=g=>a(r).password=g),placeholder:"Password",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),o("div",null,[e(m,{type:"submit",block:"",loading:a(w)==="pending"||a(D)==="pending"},{default:n(()=>[...t[2]||(t[2]=[i("Log in",-1)])]),_:1},8,["loading"]),e(m,{variant:"link",color:"blue",padded:!1,class:"mt-2",to:"/forgot-password"},{default:n(()=>[...t[3]||(t[3]=[i(" Lupa password ",-1)])]),_:1})])],32),e(d,{label:"ATAU",class:"my-4",ui:{label:"text-gray-300 font-normal"}}),e(_),o("p",mt,[t[5]||(t[5]=i(" Baru di Syopo? ",-1)),e(c,{to:"/registration",class:"text-primary"},{default:n(()=>[...t[4]||(t[4]=[i("Daftar",-1)])]),_:1})])]}),_:1})])]),_:1})])}}};export{Pt as default};
