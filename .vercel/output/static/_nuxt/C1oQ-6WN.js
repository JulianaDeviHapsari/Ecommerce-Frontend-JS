import{f as M,c as k,o as p,a as d,i as P,b as s,t as U,w as u,d as D,k as R,g as t,I as be,l as ke,s as G,r as F,J as $e,v as me,h as O,j as pe,F as J,p as _e,K as he,B as Ve}from"./BVdw5vJQ.js";import{_ as ve}from"./BPDoLG8j.js";import{_ as Ue}from"./Br08c1V3.js";import{u as q}from"./BFX_Otd8.js";import{r as fe,u as H}from"./CCYVfaL6.js";import{_ as ye}from"./D_Ip9zNA.js";import{_ as Ce}from"./0-e7FVdg.js";import{_ as Ae}from"./BNT2PxbG.js";import{_ as Be}from"./D9ImkJXs.js";import{_ as Se}from"./BnWJvLOa.js";import{_ as je}from"./BOlt6tZa.js";import{_ as Me}from"./DF4dXhcg.js";import{_ as Ne}from"./p7QnFScQ.js";import{_ as we}from"./DE8bu4_G.js";import{u as ze,r as B}from"./COQxO7zj.js";import"./DOzJKxRB.js";import"./BSNo9jaY.js";import"./C97eXVNd.js";import"./Dq2jcSPC.js";import"./9dOsKKNX.js";import"./DOwuRLCg.js";import"./CxIZtCgj.js";import"./Bish5eGS.js";import"./C0tuFO62.js";import"./BwKW8Zfl.js";import"./f51bCrOI.js";import"./Bm92f-5u.js";const Te={class:"py-4 text-sm flex flex-col gap-1"},De={class:"flex justify-between items-center gap-3"},Fe={class:"flex divide-x items-center"},Ie={class:"text-base font-medium pr-2"},Ee={class:"text-black/55 pl-2"},Ke={class:"flex justify-between items-start text-black/55"},Oe={key:0},Re={key:0},Le={__name:"CardItem",props:{item:{type:Object,default:()=>({})}},emits:["change","change:status"],setup(r,{emit:f}){const y=r,o=f,{execute:g,status:i}=q(M(()=>`/server/api/address/${y.item.uuid}/set-default`));async function n(){y.item.is_default||(await g(),i.value==="success"&&fe("address-list"))}return(c,m)=>{var S,h,_;const $=R,C=Ue;return p(),k("div",Te,[d("div",De,[d("div",Fe,[d("p",Ie,U(r.item.receiver_name),1),d("span",Ee,U(r.item.receiver_phone),1)]),s($,{color:"blue",variant:"link",padded:!1,size:"xs",onClick:m[0]||(m[0]=I=>o("change",r.item))},{default:u(()=>[...m[1]||(m[1]=[D(" Ubah ",-1)])]),_:1})]),d("div",Ke,[d("div",null,[d("p",null,U(r.item.detail_address),1),d("p",null,U(r.item.district)+", "+U((S=r.item.city)==null?void 0:S.name)+", "+U((_=(h=r.item.city)==null?void 0:h.province)==null?void 0:_.name)+", "+U(r.item.postal_code),1),r.item.address_note?(p(),k("p",Oe,U(r.item.address_note),1)):P("",!0)]),s($,{color:"white",size:"xs",disabled:r.item.is_default,loading:t(i)==="pending",onClick:n},{default:u(()=>[...m[2]||(m[2]=[D(" Atur sebagai utama ",-1)])]),_:1},8,["disabled","loading"])]),r.item.is_default?(p(),k("div",Re,[s(C,{color:"primary",variant:"outline",size:"xs"},{default:u(()=>[...m[3]||(m[3]=[D("Utama",-1)])]),_:1})])):P("",!0)])}}},Pe={class:"max-h-96 overflow-y-auto"},Ge={key:0,class:"space-y-3 p-2"},Je={key:1,class:"text-center my-3 text-black/40"},qe={__name:"InputSelectCity",props:be({placeholder:{type:String,default:"Provinsi, Kota"}},{city:{type:Object,default:()=>({uuid:null,name:null})},cityModifiers:{},province:{type:Object,default:()=>({uuid:null,name:null})},provinceModifiers:{}}),emits:["update:city","update:province"],setup(r){const f=ke(),y=G(r,"city"),o=G(r,"province"),g=F(0),i=$e({province:null,city:null});me(y,e=>{i.city={uuid:e==null?void 0:e.uuid,name:e==null?void 0:e.name}},{immediate:!0}),me(o,e=>{i.province={uuid:e==null?void 0:e.uuid,name:e==null?void 0:e.name}},{immediate:!0});const n=M(()=>{var e;return`${((e=i.province)==null?void 0:e.name)||""}${i.city?`, ${i.city.name}`:""}`}),c=M(()=>{var e;return[{label:"Provinsi",key:"province"},{label:"Kota",key:"city",disabled:!((e=i.province)!=null&&e.uuid)}]}),m=M(()=>({city:I.value,province:_.value})),{data:$,status:C}=H("/server/api/province",{key:"province-list",getCachedData(){var e,a;return((e=f.payload.data)==null?void 0:e["province-list"])||((a=f.static.data)==null?void 0:a["province-list"])}}),{data:S,status:h}=H("/server/api/city",{immediate:!1,params:M(()=>{var e;return{province_uuid:(e=i.province)==null?void 0:e.uuid}})}),_=M(()=>{var e;return((e=$.value)==null?void 0:e.data)||[]}),I=M(()=>{var e;return((e=S.value)==null?void 0:e.data)||[]});async function E(e,a,V){i[a]=e,await he(),a==="province"?(i.city=null,g.value=1):(y.value={uuid:i.city.uuid,name:i.city.name},o.value={uuid:i.province.uuid,name:i.province.name},g.value=0,V())}function L(e){e||(g.value=0,i.city||(i.province=null))}return(e,a)=>{const V=ye,v=ve,T=R,w=Ae,j=Be;return p(),O(j,{popper:{placement:"bottom-start",strategy:"absolute"},ui:{width:"w-full",rounded:"rounded-sm"},"onUpdate:open":L},{panel:u(({close:z})=>[d("div",null,[s(w,{modelValue:t(g),"onUpdate:modelValue":a[0]||(a[0]=b=>pe(g)?g.value=b:null),items:t(c),ui:{list:{background:"bg-white border-b",padding:"p-0",rounded:"rounded-none",marker:{wrapper:"!top-[0px] left-0 !h-[100%] border-b-2 border-primary",rounded:"rounded-none",shadow:"shadow-none"},tab:{active:"text-primary",inactive:"text-black/80",rounded:"rounded-none"}}}},{item:u(({item:b})=>[d("div",Pe,[t(C)==="pending"||t(h)==="pending"?(p(),k("div",Ge,[s(v,{class:"h-4"}),s(v,{class:"h-4"}),s(v,{class:"h-4"}),s(v,{class:"h-4"})])):(p(),k(J,{key:1},[t(m)[b.key].length?(p(!0),k(J,{key:0},_e(t(m)[b.key],A=>{var N;return p(),O(T,{key:A.uuid,variant:"ghost",block:"",color:((N=t(i)[b.key])==null?void 0:N.uuid)===A.uuid?"primary":"gray",class:"justify-start",label:A.name,onClick:x=>E(A,b.key,z)},null,8,["color","label","onClick"])}),128)):(p(),k("p",Je," Tidak ada data yang ditemukan "))],64))])]),_:2},1032,["modelValue","items"])])]),default:u(()=>[s(V,{"model-value":t(n),placeholder:r.placeholder,class:"w-full",size:"lg"},null,8,["model-value","placeholder"])]),_:1})}}},He={class:"col-span-2"},Qe={key:0,class:"text-sm mb-2 text-red-500"},We={class:"flex justify-end mt-6 gap-2 col-span-2"},Xe={__name:"ModalMutation",props:{open:{type:Boolean,default:!1},openModifiers:{}},emits:["update:open"],setup(r,{expose:f}){const y=G(r,"open"),o=F({is_default:!1,receiver_name:"",receiver_phone:"",district:"",postal_code:"",detail_address:"",address_note:"",type:"",city:{uuid:"",name:""},province:{uuid:"",name:""}}),g={is_default:{required:B},receiver_name:{required:B},receiver_phone:{required:B},district:{required:B},postal_code:{required:B},detail_address:{required:B},address_note:{},type:{required:B},city:{uuid:{required:B}},province:{uuid:{required:B}}},i=F({}),n=ze(g,o,{$autoDirty:!0,$externalResults:i}),c=[{label:"Rumah",value:"home"},{label:"Kantor",value:"office"}],{execute:m,status:$,error:C}=q("/server/api/address"),{execute:S,status:h,error:_}=q(M(()=>{var e;return`/server/api/address/${(e=o.value)==null?void 0:e.uuid}`}));function I(e){e&&typeof e=="object"&&(o.value=e)}function E(){o.value={is_default:!1,receiver_name:"",receiver_phone:"",district:"",postal_code:"",detail_address:"",address_note:"",type:"",city:{uuid:"",name:""},province:{uuid:"",name:""}},n.value.$reset(),y.value=!1}async function L(){var j,z,b,A,N;if(!await n.value.$validate())return;const{city:a,province:V,is_default:v,...T}=o.value,w={...T,is_default:v?1:0,city_uuid:a.uuid};if((j=o.value)!=null&&j.uuid?await S({...w,_method:"PATCH"}):await m(w),C.value||_.value){if((b=(z=(C.value||_.value).data)==null?void 0:z.meta)!=null&&b.validations){const x={...(N=(A=(C.value||_.value).data)==null?void 0:A.meta)==null?void 0:N.validations};x!=null&&x.city_uuid&&Object.assign(x,{city:{uuid:x.city_uuid.map(K=>K.replace("city uuid","value"))}}),i.value=x}return}($.value==="success"||h.value==="success")&&(fe("address-list"),E())}return f({setDefaultValue:I}),(e,a)=>{const V=ye,v=Ce,T=qe,w=Se,j=R,z=je,b=Me,A=Ne,N=we;return p(),O(N,{modelValue:y.value,"onUpdate:modelValue":a[10]||(a[10]=x=>y.value=x)},{default:u(()=>[s(A,{ui:{rounded:"rounded-sm"}},{default:u(()=>{var x,K,Q,W,X,Y,Z,ee,te,ae,oe,se,ne,ie,le,re,de,ue;return[a[12]||(a[12]=d("h3",{class:"text-xl font-normal"},"Alamat Baru",-1)),d("form",{class:"grid grid-cols-2 gap-5 mt-5",onSubmit:Ve(L,["prevent"])},[s(v,{error:(K=(x=t(n).receiver_name.$errors)==null?void 0:x[0])==null?void 0:K.$message},{default:u(()=>[s(V,{modelValue:t(o).receiver_name,"onUpdate:modelValue":a[0]||(a[0]=l=>t(o).receiver_name=l),placeholder:"Nama Lengkap",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),s(v,{error:(W=(Q=t(n).receiver_phone.$errors)==null?void 0:Q[0])==null?void 0:W.$message},{default:u(()=>[s(V,{modelValue:t(o).receiver_phone,"onUpdate:modelValue":a[1]||(a[1]=l=>t(o).receiver_phone=l),placeholder:"Nomor Telepon",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),s(v,{class:"col-span-2",error:((Y=(X=t(n).city.uuid.$errors)==null?void 0:X[0])==null?void 0:Y.$message)||((ee=(Z=t(n).province.uuid.$errors)==null?void 0:Z[0])==null?void 0:ee.$message)},{default:u(()=>[s(T,{city:t(o).city,"onUpdate:city":a[2]||(a[2]=l=>t(o).city=l),province:t(o).province,"onUpdate:province":a[3]||(a[3]=l=>t(o).province=l)},null,8,["city","province"])]),_:1},8,["error"]),s(v,{error:(ae=(te=t(n).district.$errors)==null?void 0:te[0])==null?void 0:ae.$message},{default:u(()=>[s(V,{modelValue:t(o).district,"onUpdate:modelValue":a[4]||(a[4]=l=>t(o).district=l),placeholder:"Kecamatan",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),s(v,{error:(se=(oe=t(n).postal_code.$errors)==null?void 0:oe[0])==null?void 0:se.$message},{default:u(()=>[s(V,{modelValue:t(o).postal_code,"onUpdate:modelValue":a[5]||(a[5]=l=>t(o).postal_code=l),placeholder:"Kode Pos",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),s(v,{error:(ie=(ne=t(n).detail_address.$errors)==null?void 0:ne[0])==null?void 0:ie.$message,class:"col-span-2"},{default:u(()=>[s(w,{modelValue:t(o).detail_address,"onUpdate:modelValue":a[6]||(a[6]=l=>t(o).detail_address=l),placeholder:"Nama Jalan, Gedung, No. Rumah",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),s(v,{error:(re=(le=t(n).address_note.$errors)==null?void 0:le[0])==null?void 0:re.$message,class:"col-span-2"},{default:u(()=>[s(V,{modelValue:t(o).address_note,"onUpdate:modelValue":a[7]||(a[7]=l=>t(o).address_note=l),placeholder:"Detail Lainnya (Cth: Blok / Unit No., Patokan)",size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),d("div",He,[a[11]||(a[11]=d("label",{class:"text-sm font-normal text-black/80"}," Tandai Sebagai: ",-1)),s(z,{modelValue:t(o).type,"onUpdate:modelValue":a[8]||(a[8]=l=>t(o).type=l),items:c,class:"!flex !gap-2 justify-start my-2"},{item:u(({label:l,value:ge,selected:ce,onClick:xe})=>[s(j,{color:ce?"primary":"white",variant:ce?"soft":"solid",ui:{padding:{sm:"py-3 px-3"}},onClick:tt=>xe(ge)},{default:u(()=>[D(U(l),1)]),_:2},1032,["color","variant","onClick"])]),_:1},8,["modelValue"]),(ue=(de=t(n).type.$errors)==null?void 0:de[0])!=null&&ue.$message?(p(),k("p",Qe,U(t(n).type.$errors[0].$message),1)):P("",!0),s(b,{modelValue:t(o).is_default,"onUpdate:modelValue":a[9]||(a[9]=l=>t(o).is_default=l),label:"Atur sebagai Alamat Pribadi",ui:{label:"text-black/55"}},null,8,["modelValue"])]),d("div",We,[s(j,{label:"Nanti Saja",color:"gray",class:"max-w-36",variant:"link",block:"",onClick:E}),s(j,{type:"submit",label:"Ok",class:"max-w-36",block:"",loading:t($)==="pending"||t(h)==="pending"},null,8,["loading"])])],32)]}),_:1})]),_:1},8,["modelValue"])}}},Ye={class:"flex justify-between gap-4 items-center"},Ze={class:"divide-y"},et={key:0,class:"space-y-2 mt-4"},St={__name:"address",setup(r){const f=F(!1),y=F(),{data:o,status:g}=H("/server/api/address",{key:"address-list"});function i(n){y.value.setDefaultValue({uuid:n.uuid,is_default:!!n.is_default,receiver_name:n.receiver_name,receiver_phone:n.receiver_phone,district:n.district,postal_code:n.postal_code,detail_address:n.detail_address,address_note:n.address_note,type:n.type,city:{uuid:n.city.uuid,name:n.city.name},province:{uuid:n.city.province.uuid,name:n.city.province.name}}),f.value=!0}return(n,c)=>{var h;const m=R,$=ve,C=Le,S=Xe;return p(),k("div",null,[d("div",Ye,[c[3]||(c[3]=d("h3",{class:"text-lg font-medium"},"Alamat Saya",-1)),s(m,{icon:"i-heroicons:plus",onClick:c[0]||(c[0]=_=>f.value=!0)},{default:u(()=>[...c[2]||(c[2]=[D("Tambah Alamat Baru",-1)])]),_:1})]),c[4]||(c[4]=d("hr",{class:"mt-5 mb-3 border-gray-200/60"},null,-1)),c[5]||(c[5]=d("h4",{class:"text-lg font-normal"},"Alamat",-1)),d("div",Ze,[t(g)==="pending"?(p(),k("div",et,[s($,{class:"h-4 w-[250px]"}),s($,{class:"h-4 w-[200px]"})])):(p(!0),k(J,{key:1},_e((h=t(o))==null?void 0:h.data,_=>(p(),O(C,{key:_.uuid,item:_,onChange:i},null,8,["item"]))),128))]),s(S,{ref_key:"modalMutationElement",ref:y,open:t(f),"onUpdate:open":c[1]||(c[1]=_=>pe(f)?f.value=_:null)},null,8,["open"])])}}};export{St as default};
