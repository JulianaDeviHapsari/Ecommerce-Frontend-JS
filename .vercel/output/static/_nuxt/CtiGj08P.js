import{_ as be}from"./DDjGGqVe.js";import{_ as ge,J as ke,f as v,y as he,l as $e,h as L,c as f,g as a,a as e,i as J,b as m,t as d,w as q,F as K,p as re,k as we,o as p,B as Ie,d as ie}from"./BVdw5vJQ.js";import{_ as Pe,a as Ue,I as Se,b as Ve,c as Be,d as De,e as Ne}from"./BMPZeR4Y.js";import{_ as Xe}from"./BnWJvLOa.js";import{_ as je}from"./0-e7FVdg.js";import{_ as Ce}from"./p7QnFScQ.js";import{_ as Ae}from"./DE8bu4_G.js";import{_ as Oe}from"./BrHeijYS.js";import{_ as Te}from"./rUE9myqw.js";import{u as Me,r as Re}from"./COQxO7zj.js";import{u as Fe}from"./CCYVfaL6.js";import{u as ze}from"./BFX_Otd8.js";import{f as Q}from"./CX-HCZMl.js";import"./j9dIvsdS.js";import"./BSNo9jaY.js";import"./Bish5eGS.js";import"./DOwuRLCg.js";import"./C97eXVNd.js";import"./C0tuFO62.js";import"./9dOsKKNX.js";import"./Bm92f-5u.js";import"./CxIZtCgj.js";import"./BwKW8Zfl.js";import"./0kcxaRLk.js";import"./DOzJKxRB.js";const Ee={key:1,class:"text-sm text-black/80"},He={class:"bg-white divide-y divide-dashed"},Le={class:"flex justify-between gap-4 px-6 py-5"},qe={class:"divide-x"},Ge={class:"px-4"},Je={class:"px-4 uppercase text-primary"},Ke={class:"px-6 py-10"},Qe={key:0,class:"bg-yellow-50/30 flex justify-end px-6 py-3 gap-2"},We={class:"flex justify-end gap-4 mt-6"},Ye={class:"px-6 py-5"},Ze={class:"flex justify-between items-center"},et={class:"text-right text-xs text-black/55"},tt={class:"uppercase"},st={class:"flex divide-x mt-3"},at={class:"w-80 py-2 pr-3"},ot={class:"text-black/55 mt-2"},nt={class:"text-black/55"},rt={class:"pl-3"},it={class:"bg-gray-50 divide-y"},dt={class:"px-6 py-3"},lt={class:"divide-y"},ct={class:"order-price"},ut={key:0,class:"flex items-center gap-2 justify-end"},pt={__name:"[orderId]",setup(mt){const i=ke({open:!1,status:"",form:{description:""}}),G=Me({description:{required:Re}},v(()=>({description:i.form.description})),{$autoDirty:!0}),y=he(),W=$e(),{data:o,status:de,refresh:le}=Fe(`/server/api/seller-dashboard/order/${y.params.orderId}`,{key:`order-seller-${y.params.orderId}`,getCachedData(){var t,s;return((t=W.payload.data)==null?void 0:t[`order-seller-${y.params.orderId}`])||((s=W.static.data)==null?void 0:s[`order-seller-${y.params.orderId}`])},transform(t){return(t==null?void 0:t.data)||{}}}),{execute:Y,status:Z}=ze(v(()=>`/server/api/seller-dashboard/order/${y.params.orderId}/status`),{onResponse({response:t}){t.ok&&(i.open=!1,i.status="",i.form.description="",G.value.$reset(),le())}}),l=v(()=>{var t;return((t=o.value)==null?void 0:t.last_status)||{}}),ce=v(()=>{var M,R,F,z,E,H,x,b,g,k,h,$,w,I,P,U,S,V,B,D,N,X,j,C,A,O,T;const t=(R=(M=o.value)==null?void 0:M.status)==null?void 0:R.find(u=>u.status==="pending_payment"),s=(z=(F=o.value)==null?void 0:F.status)==null?void 0:z.find(u=>u.status==="paid"),n=(H=(E=o.value)==null?void 0:E.status)==null?void 0:H.find(u=>u.status==="on_processing"),r=(b=(x=o.value)==null?void 0:x.status)==null?void 0:b.find(u=>u.status==="on_delivery"),_=(k=(g=o.value)==null?void 0:g.status)==null?void 0:k.find(u=>u.status==="done");return[{title:"Pesanan Dibuat",time:t==null?void 0:t.created_at,passed:!["pending_payment","failed"].includes((h=l.value)==null?void 0:h.status)&&t,active:(($=l.value)==null?void 0:$.status)==="pending_payment",icon:Se},{title:`Pesanan${s?"":" Belum"} Dibayarkan (Rp${Q((w=o.value)==null?void 0:w.total)})`,time:s==null?void 0:s.created_at,passed:((I=l.value)==null?void 0:I.status)!=="paid"&&s,active:((P=l.value)==null?void 0:P.status)==="paid",icon:Ve},{title:"Sedang Dikemas",time:n==null?void 0:n.created_at,icon:Be,passed:((U=l.value)==null?void 0:U.status)!=="on_processing"&&n,active:((S=l.value)==null?void 0:S.status)==="on_processing"},{title:"Dikirim",time:r==null?void 0:r.created_at,icon:De,passed:((V=l.value)==null?void 0:V.status)!=="on_delivery"&&r,active:((B=l.value)==null?void 0:B.status)==="on_delivery"},{title:(X=(N=(D=o.value)==null?void 0:D.items)==null?void 0:N[0])!=null&&X.is_reviewed?"Selesai":"Belum Dinilai",time:(A=(C=(j=o.value)==null?void 0:j.items)==null?void 0:C[0])!=null&&A.is_reviewed?_==null?void 0:_.created_at:"",icon:Ne,passed:((O=l.value)==null?void 0:O.status)!=="done"&&_,active:((T=l.value)==null?void 0:T.status)==="done"}]}),ue=v(()=>{var t,s;return(s=(t=o.value)==null?void 0:t.status)==null?void 0:s.map((n,r,_)=>({title:n==null?void 0:n.description,time:n==null?void 0:n.created_at,active:r===_.length-1})).sort((n,r)=>new Date(r.time)-new Date(n.time))}),pe=v(()=>{var t,s;return(s=(t=o.value)==null?void 0:t.items)==null?void 0:s.reduce((n,r)=>(n+=r.total,n),0)}),me=v(()=>{var t;return[{label:"Subtotal Produk",value:`Rp ${Q(pe.value)}`},{label:"Total Pesanan",value:`Rp ${Q((t=o.value)==null?void 0:t.total)}`,class:"text-primary text-2xl"}]});function _e(t){i.open=!0,i.status=t,i.form.description=""}function ve(){i.open=!1,i.form.description="",G.value.$reset()}function fe(){window.confirm("Anda yakin untuk memproses order ini?")&&Y({status:"on_processing"})}function ye(){Y({status:i.status,delivery_note:i.form.description})}return(t,s)=>{var x,b,g,k,h,$,w,I,P,U,S,V,B,D,N,X,j,C,A,O,T,u,ee,te,se,ae,oe;const n=be,r=we,_=Pe,M=Xe,R=je,F=Ce,z=Ae,E=Ue,H=Oe;return a(de)==="pending"?(p(),L(n,{key:0})):(p(),f("div",Ee,[e("div",He,[e("div",Le,[m(r,{label:"Kembali",to:"/seller/order",icon:"i-heroicons:chevron-left",padded:!1,variant:"link",color:"gray"}),e("div",qe,[e("span",Ge,"NO. PESANAN. "+d((x=a(o))==null?void 0:x.invoice_number),1),e("span",Je,d((b=a(l))==null?void 0:b.description),1)])]),e("div",Ke,[m(_,{items:a(ce),class:"grid grid-cols-5"},null,8,["items"])]),["paid","on_processing","on_delivery"].includes((g=a(l))==null?void 0:g.status)?(p(),f("div",Qe,[((k=a(l))==null?void 0:k.status)==="paid"?(p(),L(r,{key:0,class:"min-w-56 justify-center",label:"Proses Order ini",onClick:fe})):J("",!0),["on_processing","on_delivery"].includes((h=a(l))==null?void 0:h.status)?(p(),L(r,{key:1,class:"min-w-56 justify-center",label:"Update Status Pengiriman",onClick:s[0]||(s[0]=c=>_e("on_delivery"))})):J("",!0),m(z,{modelValue:a(i).open,"onUpdate:modelValue":s[2]||(s[2]=c=>a(i).open=c)},{default:q(()=>[m(F,null,{header:q(()=>[...s[3]||(s[3]=[ie(" Update Status Order ",-1)])]),default:q(()=>{var c,ne;return[e("form",{onSubmit:Ie(ye,["prevent"])},[m(R,{label:"Deskripsi",error:(ne=(c=a(G).$errors)==null?void 0:c[0])==null?void 0:ne.$message},{default:q(()=>[m(M,{modelValue:a(i).form.description,"onUpdate:modelValue":s[1]||(s[1]=xe=>a(i).form.description=xe)},null,8,["modelValue"])]),_:1},8,["error"]),e("div",We,[m(r,{color:"gray",variant:"link",label:"Nanti Saja",disabled:a(Z)==="pending",onClick:ve},null,8,["disabled"]),m(r,{type:"submit",label:"Simpan",loading:a(Z)==="pending"},null,8,["loading"])])],32)]}),_:1})]),_:1},8,["modelValue"])])):J("",!0),e("div",Ye,[e("div",Ze,[s[5]||(s[5]=e("p",{class:"text-xl"},"Alamat Pengiriman",-1)),e("div",et,[e("p",tt,d(($=a(o))==null?void 0:$.courier)+" - "+d((w=a(o))==null?void 0:w.courier_type),1),s[4]||(s[4]=e("p",null,"XXXXXXXXX",-1))])]),e("div",st,[e("div",at,[e("p",null,d((P=(I=a(o))==null?void 0:I.address)==null?void 0:P.receiver_name),1),e("p",ot,d((S=(U=a(o))==null?void 0:U.address)==null?void 0:S.receiver_phone),1),e("p",nt,d((B=(V=a(o))==null?void 0:V.address)==null?void 0:B.detail_address)+" "+d((N=(D=a(o))==null?void 0:D.address)==null?void 0:N.district)+", "+d((C=(j=(X=a(o))==null?void 0:X.address)==null?void 0:j.city)==null?void 0:C.name)+", "+d((u=(T=(O=(A=a(o))==null?void 0:A.address)==null?void 0:O.city)==null?void 0:T.province)==null?void 0:u.name)+", "+d((te=(ee=a(o))==null?void 0:ee.address)==null?void 0:te.postal_code)+" "+d((ae=(se=a(o))==null?void 0:se.address)==null?void 0:ae.address_note),1)]),e("div",rt,[m(E,{items:a(ue)},null,8,["items"])])])])]),e("div",it,[e("div",dt,[e("div",lt,[(p(!0),f(K,null,re((oe=a(o))==null?void 0:oe.items,c=>(p(),L(H,{key:`product-${c.uuid}`,size:"sm",class:"py-3",item:c},null,8,["item"]))),128))])]),e("div",null,[e("table",ct,[e("tbody",null,[(p(!0),f(K,null,re(a(me),c=>(p(),f("tr",{key:c.label},[e("td",null,[c.label==="Metode Pembayaran"?(p(),f("div",ut,[s[6]||(s[6]=e("img",{src:Te,class:"h-4 w-4"},null,-1)),e("span",null,d(c.label),1)])):(p(),f(K,{key:1},[ie(d(c.label),1)],64))]),e("td",null,d(c.value),1)]))),128))])])])])]))}}},Rt=ge(pt,[["__scopeId","data-v-24d34ef1"]]);export{Rt as default};
