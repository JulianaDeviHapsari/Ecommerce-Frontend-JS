import{_ as ne}from"./Cpznx1_E.js";import{_ as ie}from"./b2XhvBR1.js";import{_ as Z}from"./D_Ip9zNA.js";import{_ as ue}from"./Cm2tcYAv.js";import{_ as de}from"./BnWJvLOa.js";import{_ as me}from"./Cdgg-7JV.js";import{_ as pe}from"./0-e7FVdg.js";import{I as ce,s as W,f as N,r as ee,c as F,o as f,a as i,b as t,h as E,g as o,w as s,d as v,t as ae,k as oe,F as te,p as le,i as ge,y as ve,z as _e,l as fe,m as Ve,R as he,n as $e}from"./BVdw5vJQ.js";import{c as ke,r as c,u as re,m as X,d as ye,a as J,b as be}from"./COQxO7zj.js";import{u as xe}from"./CCYVfaL6.js";import{u as Y}from"./BFX_Otd8.js";import"./BSNo9jaY.js";import"./Bm92f-5u.js";import"./CxIZtCgj.js";import"./C97eXVNd.js";import"./C0tuFO62.js";import"./DOwuRLCg.js";import"./Dq2jcSPC.js";import"./C9URDrvn.js";import"./9dOsKKNX.js";import"./BwKW8Zfl.js";import"./f51bCrOI.js";import"./p7QnFScQ.js";import"./DOzJKxRB.js";const Ue={class:"p-4 bg-gray-100 rounded-sm"},we={class:"flex justify-between items-center"},Pe={key:1,class:"flex gap-1"},ze={class:"text-sm"},Se={class:"grid grid-cols-2 gap-4 mt-4"},Ce={class:"flex gap-2"},De={__name:"Variant",props:{modelValue:{type:String,default:""},modelModifiers:{},value:{type:Array,default:()=>[]},valueModifiers:{}},emits:ce(["delete"],["update:modelValue","update:value"]),setup(j,{emit:w}){const a=w,P=W(j,"modelValue"),u=W(j,"value"),A={name:{required:c},value:{$each:ke.forEach({name:{required:c}})}},C=re(A,N(()=>({name:P.value,value:u.value})),{$autoDirty:!0,$scope:"product"}),V=ee(!0);function H(){P.value&&(V.value=!1)}function I(D){u.value.splice(D,1)}function K(){u.value.push({name:""})}return(D,g)=>{var q,R;const B=Z,M=pe,z=oe;return f(),F("div",Ue,[i("div",we,[i("div",null,[o(V)?(f(),E(M,{key:0,error:(R=(q=o(C).name.$errors)==null?void 0:q[0])==null?void 0:R.$message},{default:s(()=>[t(B,{modelValue:P.value,"onUpdate:modelValue":g[0]||(g[0]=r=>P.value=r),autofocus:"",placeholder:"Variant Name",onBlur:H},null,8,["modelValue"])]),_:1},8,["error"])):(f(),F("div",Pe,[i("span",ze,[v(ae(P.value)+" ",1),g[3]||(g[3]=i("span",{class:"text-black/30 text-xs"},"(Atur Sendiri)",-1))]),t(z,{icon:"i-heroicons:pencil-square",variant:"link",color:"blue",padded:!1,onClick:g[1]||(g[1]=r=>V.value=!0)})]))]),t(z,{variant:"ghost",icon:"i-heroicons:x-mark",size:"xs",color:"gray",onClick:g[2]||(g[2]=r=>a("delete"))})]),g[4]||(g[4]=i("hr",{class:"my-4"},null,-1)),i("div",Se,[(f(!0),F(te,null,le(u.value,(r,e)=>{var l,n,m,S;return f(),E(M,{key:`variant-${e}`,error:(S=(m=(n=(l=o(C).value.$each.$response.$errors)==null?void 0:l[e])==null?void 0:n.name)==null?void 0:m[0])==null?void 0:S.$message},{default:s(()=>[i("div",Ce,[t(B,{modelValue:r.name,"onUpdate:modelValue":L=>r.name=L,class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),u.value.length>1?(f(),E(z,{key:0,icon:"i-heroicons:trash",padded:!1,size:"xs",variant:"link",color:"gray",onClick:L=>I(e)},null,8,["onClick"])):ge("",!0)])]),_:2},1032,["error"])}),128))]),t(z,{icon:"i-heroicons:plus",label:"Tambah",size:"xs",color:"white",class:"mt-4",onClick:K})])}}},Be={class:"space-y-4"},Ne={class:"mt-4 space-y-6"},Fe={class:"flex gap-6 items-center"},Ae={class:"mt-4 space-y-6"},Ie={class:"grid grid-cols-2 gap-6"},Me={class:"space-y-4"},qe={class:"p-4 bg-gray-100 rounded-sm"},Re={class:"mt-4 space-y-6"},Le={class:"flex"},Te={class:"flex gap-2 items-center"},Ee={class:"flex justify-end gap-4"},ca={__name:"[[productId]]",setup(j){const w=ve();w.meta.breadcrumb=w.params.action==="add"?[{label:"Produk Saya",to:"/seller/product"},{label:"Tambah Produk Baru"}]:[{label:"Produk Saya",to:"/seller/product"},{label:"Ubah Produk"}];const a=ee({name:"",price:null,price_sale:null,stock:null,category_slug:"",description:"",weight:null,length:null,width:null,height:null,video:[],images:[],variations:[{name:"",value:[{name:""}]}]}),P=N(()=>({name:{required:c},price:{required:c,minValue:J(100)},price_sale:{minValue:J(100),maxValue:be(N(()=>a.value.price))},stock:{required:c,minValue:J(1)},category_slug:{required:c},description:{required:c,maxLength:ye(3e3)},weight:{required:c},length:{required:c},width:{required:c},height:{required:c},images:{required:c,minLength:X(1)},video:{required:c,minLength:X(1)}})),u=re(P,a,{$autoDirty:!0,$scope:"product"}),A=_e(),C=fe(),V=Ve(),{data:H,status:I}=xe("/server/api/category",{key:"category-list",transform(r){return((r==null?void 0:r.data)||[]).reduce((e,l)=>(e.push(...l.childs.map(n=>({...n,icon:l.icon,name:`${l.name} - ${n.name}`}))),e),[])},getCachedData(){var r,e;return((r=C.payload.data)==null?void 0:r["category-list"])||((e=C.static.data)==null?void 0:e["category-list"])}}),{execute:K,status:D}=Y("/server/api/seller-dashboard/product",{onResponse({response:r}){r.ok&&(A.add({color:"green",title:"Berhasil menambahkan produk"}),V.push("/seller/product"))}}),{execute:g,status:B}=Y(N(()=>`/server/api/seller-dashboard/product/${w.params.productId}`),{onResponse({response:r}){r.ok&&(A.add({color:"green",title:"Berhasil mengubah produk"}),V.push("/seller/product"))}}),M=N(()=>{var r;return(r=H.value)==null?void 0:r.map(e=>({...e,icon:void 0}))});function z(){a.value.variations.push({name:"",value:[{name:""}]})}function q(r){a.value.variations.splice(r,1)}async function R(){if(!await u.value.$validate())return;const e=new FormData;if(e.append("name",a.value.name),e.append("price",a.value.price),a.value.price_sale&&e.append("price_sale",a.value.price_sale),e.append("stock",a.value.stock),e.append("category_slug",a.value.category_slug),e.append("description",a.value.description),e.append("weight",a.value.weight),e.append("length",a.value.length),e.append("width",a.value.width),e.append("height",a.value.height),a.value.video[0]&&typeof a.value.video[0]!="string"&&e.append("video",a.value.video[0]),a.value.images.forEach(l=>{e.append(typeof l=="string"?"old_images[]":"images[]",l)}),a.value.variations.forEach((l,n)=>{e.append(`variations[${n}][name]`,l.name),l.value.forEach((m,S)=>{e.append(`variations[${n}][values][${S}]`,m.name)})}),w.params.productId){e.append("_method","PATCH"),g(e);return}K(e)}return he(()=>{var r;if(w.params.action==="edit"){const e=(r=V.options.history.state)==null?void 0:r.product;if(!e){V.replace("/seller/product");return}const l=JSON.parse(e);a.value={name:l.name,price:l.price,price_sale:l.price_sale,stock:l.stock,category_slug:l.category.slug,description:l.description,weight:l.weight,length:l.length,width:l.width,height:l.height,video:[l.video_url],images:l.images,variations:l.variations.map(n=>({name:n.name,value:n.values.map(m=>({name:m}))}))}}}),(r,e)=>{const l=ne,n=ie,m=Z,S=ue,L=de,T=me,se=De,G=oe,O=$e;return f(),F("form",Be,[t(T,{title:"Informasi Produk"},{default:s(()=>{var h,$,k,y,b,x,d,U,p,Q;return[i("div",Ne,[t(n,{label:"Foto Produk",required:"",error:($=(h=o(u).images.$errors)==null?void 0:h[0])==null?void 0:$.$message},{default:s(()=>[t(l,{modelValue:o(a).images,"onUpdate:modelValue":e[0]||(e[0]=_=>o(a).images=_),max:9},null,8,["modelValue"])]),_:1},8,["error"]),t(n,{label:"Video Produk",error:(y=(k=o(u).video.$errors)==null?void 0:k[0])==null?void 0:y.$message},{default:s(()=>[i("div",Fe,[t(l,{modelValue:o(a).video,"onUpdate:modelValue":e[1]||(e[1]=_=>o(a).video=_),max:1,type:"video",icon:"i-heroicons:video-camera-solid"},null,8,["modelValue"]),e[12]||(e[12]=i("div",{class:"text-xs text-black/50"},[i("p",null," File video maks. harus 30Mb dengan resolusi tidak melebihi 1280 x 1280px. "),i("p",null,"Durasi: 10-60detik"),i("p",null,"Format: MP4"),i("p",null," Catatan: Kamu dapat menampilkan produk saat video sedang diproses. Video akan muncul setelah berhasil diproses. ")],-1))])]),_:1},8,["error"]),t(n,{label:"Nama Produk",error:(x=(b=o(u).name.$errors)==null?void 0:b[0])==null?void 0:x.$message},{default:s(()=>[t(m,{modelValue:o(a).name,"onUpdate:modelValue":e[2]||(e[2]=_=>o(a).name=_),size:"lg"},null,8,["modelValue"])]),_:1},8,["error"]),t(n,{label:"Kategori",required:"",error:(U=(d=o(u).category_slug.$errors)==null?void 0:d[0])==null?void 0:U.$message},{default:s(()=>[t(S,{modelValue:o(a).category_slug,"onUpdate:modelValue":e[3]||(e[3]=_=>o(a).category_slug=_),options:o(M),size:"lg",loading:o(I)==="pending",disabled:o(I)==="pending","value-attribute":"slug","option-attribute":"name"},null,8,["modelValue","options","loading","disabled"])]),_:1},8,["error"]),t(n,{label:"Deskripsi Produk",required:"",help:`${o(a).description.length}/3000`,error:(Q=(p=o(u).description.$errors)==null?void 0:p[0])==null?void 0:Q.$message},{default:s(()=>[t(L,{modelValue:o(a).description,"onUpdate:modelValue":e[4]||(e[4]=_=>o(a).description=_),size:"lg"},null,8,["modelValue"])]),_:1},8,["help","error"])])]}),_:1}),t(T,{title:"Informasi Penjualan"},{default:s(()=>{var h,$,k,y,b,x;return[i("div",Ae,[i("div",Ie,[t(n,{label:"Harga",error:($=(h=o(u).price.$errors)==null?void 0:h[0])==null?void 0:$.$message,required:""},{default:s(()=>[t(m,{modelValue:o(a).price,"onUpdate:modelValue":e[5]||(e[5]=d=>o(a).price=d),size:"lg",type:"number"},{leading:s(()=>[...e[13]||(e[13]=[v("Rp",-1)])]),_:1},8,["modelValue"])]),_:1},8,["error"]),t(n,{label:"Harga Diskon",error:(y=(k=o(u).price_sale.$errors)==null?void 0:k[0])==null?void 0:y.$message},{default:s(()=>[t(m,{modelValue:o(a).price_sale,"onUpdate:modelValue":e[6]||(e[6]=d=>o(a).price_sale=d),size:"lg",type:"number"},{leading:s(()=>[...e[14]||(e[14]=[v("Rp",-1)])]),_:1},8,["modelValue"])]),_:1},8,["error"])]),t(n,{label:"Stok",error:(x=(b=o(u).stock.$errors)==null?void 0:b[0])==null?void 0:x.$message,required:""},{default:s(()=>[t(m,{modelValue:o(a).stock,"onUpdate:modelValue":e[7]||(e[7]=d=>o(a).stock=d),size:"lg",type:"number"},null,8,["modelValue"])]),_:1},8,["error"]),t(n,{label:"Variasi"},{default:s(()=>[i("div",Me,[(f(!0),F(te,null,le(o(a).variations,(d,U)=>(f(),E(se,{key:`variations-${U}`,modelValue:d.name,"onUpdate:modelValue":p=>d.name=p,value:d.value,"onUpdate:value":p=>d.value=p,onDelete:p=>q(U)},null,8,["modelValue","onUpdate:modelValue","value","onUpdate:value","onDelete"]))),128)),i("div",qe,[t(G,{color:"white",class:"text-primary",size:"xs",icon:"i-heroicons:plus",onClick:z},{default:s(()=>[v(" Tambah Variasi "+ae(o(a).variations.length+1),1)]),_:1})])])]),_:1})])]}),_:1}),t(T,{title:"Pengiriman"},{default:s(()=>{var h,$,k,y,b,x,d,U;return[i("div",Re,[t(n,{label:"Berat",required:"",error:($=(h=o(u).weight.$errors)==null?void 0:h[0])==null?void 0:$.$message},{default:s(()=>[i("div",Le,[t(m,{modelValue:o(a).weight,"onUpdate:modelValue":e[8]||(e[8]=p=>o(a).weight=p),size:"lg",type:"number"},{trailing:s(()=>[...e[15]||(e[15]=[v("gr",-1)])]),_:1},8,["modelValue"])])]),_:1},8,["error"]),t(n,{label:"Ukuran Paket",error:((y=(k=o(u).length.$errors)==null?void 0:k[0])==null?void 0:y.$message)||((x=(b=o(u).width.$errors)==null?void 0:b[0])==null?void 0:x.$message)||((U=(d=o(u).height.$errors)==null?void 0:d[0])==null?void 0:U.$message)},{default:s(()=>[i("div",Te,[t(m,{modelValue:o(a).length,"onUpdate:modelValue":e[9]||(e[9]=p=>o(a).length=p),size:"lg",type:"number",placeholder:"L"},{trailing:s(()=>[...e[16]||(e[16]=[v("cm",-1)])]),_:1},8,["modelValue"]),t(O,{name:"i-heroicons:x-mark",class:"text-black/20"}),t(m,{modelValue:o(a).width,"onUpdate:modelValue":e[10]||(e[10]=p=>o(a).width=p),size:"lg",type:"number"},{trailing:s(()=>[...e[17]||(e[17]=[v("cm",-1)])]),_:1},8,["modelValue"]),t(O,{name:"i-heroicons:x-mark",class:"text-black/20"}),t(m,{modelValue:o(a).height,"onUpdate:modelValue":e[11]||(e[11]=p=>o(a).height=p),size:"lg",type:"number"},{trailing:s(()=>[...e[18]||(e[18]=[v("cm",-1)])]),_:1},8,["modelValue"])])]),_:1},8,["error"])])]}),_:1}),t(T,{class:"sticky bottom-4"},{default:s(()=>[i("div",Ee,[t(G,{color:"white",size:"xs",disabled:o(D)==="pending"||o(B)==="pending",to:"/seller/product"},{default:s(()=>[...e[19]||(e[19]=[v(" Kembali ",-1)])]),_:1},8,["disabled"]),t(G,{color:"primary",size:"xs",loading:o(D)==="pending"||o(B)==="pending",onClick:R},{default:s(()=>[...e[20]||(e[20]=[v(" Simpan ",-1)])]),_:1},8,["loading"])])]),_:1})])}}};export{ca as default};
