import{_ as he}from"./DDjGGqVe.js";import{_ as ge,r as de,y as we,l as De,f,h as ue,c as v,g as o,a as s,b as y,i as Q,t as r,d as h,w as $e,F as q,p as ce,j as Ie,k as Re,o as c}from"./BVdw5vJQ.js";import{_ as Pe,a as je,I as Be,b as Se,c as Ne,d as Me,e as Xe}from"./BMPZeR4Y.js";import{_ as Ae}from"./BD6unLEd.js";import{_ as Ce}from"./BrHeijYS.js";import{_ as Ve}from"./DxHTw6tJ.js";import{_ as Oe}from"./rUE9myqw.js";import{u as Te}from"./CCYVfaL6.js";import{g as Ee}from"./D9IPX4lg.js";import{f as b}from"./CX-HCZMl.js";import{u as Ke}from"./BFX_Otd8.js";import{f as G}from"./C__g2RLv.js";import{a as ze}from"./B4TYcooI.js";import{d as Fe}from"./B8iLdbf-.js";import"./j9dIvsdS.js";import"./0kcxaRLk.js";import"./C_ZdkJcR.js";import"./BnWJvLOa.js";import"./BSNo9jaY.js";import"./0-e7FVdg.js";import"./Cpznx1_E.js";import"./DF4dXhcg.js";import"./COQxO7zj.js";import"./C4HB1ECi.js";import"./DOzJKxRB.js";import"./p7QnFScQ.js";import"./DE8bu4_G.js";import"./Bish5eGS.js";import"./DOwuRLCg.js";import"./C97eXVNd.js";import"./C0tuFO62.js";import"./9dOsKKNX.js";import"./Bm92f-5u.js";import"./CxIZtCgj.js";import"./BwKW8Zfl.js";import"./CovN8vff.js";const Le={key:1,class:"text-sm text-black/80"},He={class:"bg-white divide-y divide-dashed"},Ue={class:"flex justify-between gap-4 px-6 py-5"},Qe={class:"divide-x"},qe={class:"px-4"},Ge={class:"px-4 uppercase text-primary"},Je={class:"px-6 py-10"},We={key:0,class:"bg-yellow-50/30 flex justify-end px-6 py-3"},Ye={key:1,class:"bg-yellow-50/30 flex justify-between px-6 py-3 items-center"},Ze={class:"text-black/55"},et={class:"underline"},tt={class:"underline"},st={key:2,class:"bg-yellow-50/30 flex justify-between px-6 py-3 items-center"},at={class:"text-black/55"},ot={class:"underline"},nt={class:"px-6 py-5"},it={class:"flex justify-between items-center"},rt={class:"text-right text-xs text-black/55"},lt={class:"uppercase"},dt={class:"flex divide-x mt-3"},ut={class:"w-80 py-2 pr-3"},ct={class:"text-black/55 mt-2"},pt={class:"text-black/55"},mt={class:"pl-3"},_t={class:"bg-gray-50 divide-y"},vt={class:"px-6 py-3"},yt={class:"flex gap-2 items-center"},ft={class:"font-semibold"},bt={class:"divide-y"},xt={class:"order-price"},kt={key:0,class:"flex items-center gap-2 justify-end"},ht={__name:"[orderId]",setup(gt){const U=de(!1),J=de(),g=we(),W=De(),{data:t,status:pe,refresh:Y}=Te(`/server/api/order/${g.params.orderId}`,{key:`order-customer-${g.params.orderId}`,getCachedData(){var a,e;return((a=W.payload.data)==null?void 0:a[`order-customer-${g.params.orderId}`])||((e=W.static.data)==null?void 0:e[`order-customer-${g.params.orderId}`])},transform(a){return(a==null?void 0:a.data)||{}}}),Z=f(()=>{var n;const{start:a,end:e}=Ee((n=t.value)==null?void 0:n.courier_estimation,{returnObject:!0});return{start:G(a,"dd-MM-yyyy"),end:G(e,"dd-MM-yyyy")}}),l=f(()=>{var a,e,n,i;return(i=(a=t.value)==null?void 0:a.status)==null?void 0:i[(((n=(e=t.value)==null?void 0:e.status)==null?void 0:n.length)||0)-1]}),ee=f(()=>{var n,i;if(((n=l.value)==null?void 0:n.status)!=="done")return"";const a=new Date((i=l.value)==null?void 0:i.created_at),e=ze(a,1);return G(e,"dd-MM-yyyy")}),me=f(()=>{var i,d,p,m;if(((i=l.value)==null?void 0:i.status)!=="done")return!1;const a=new Date(ee.value);return Fe(a,new Date)===0&&!((m=(p=(d=t.value)==null?void 0:d.items)==null?void 0:p[0])!=null&&m.is_reviewed)}),_e=f(()=>{var p,m,x,k,w,D,$,I,R,P,j,B,S,N,M,X,A,C,V,O,T,E,K,z,F,L,H;const a=(m=(p=t.value)==null?void 0:p.status)==null?void 0:m.find(u=>u.status==="pending_payment"),e=(k=(x=t.value)==null?void 0:x.status)==null?void 0:k.find(u=>u.status==="paid"),n=(D=(w=t.value)==null?void 0:w.status)==null?void 0:D.find(u=>u.status==="on_processing"),i=(I=($=t.value)==null?void 0:$.status)==null?void 0:I.find(u=>u.status==="on_delivery"),d=(P=(R=t.value)==null?void 0:R.status)==null?void 0:P.find(u=>u.status==="done");return[{title:"Pesanan Dibuat",time:a==null?void 0:a.created_at,passed:!["pending_payment","failed"].includes((j=l.value)==null?void 0:j.status)&&a,active:((B=l.value)==null?void 0:B.status)==="pending_payment",icon:Be},{title:`Pesanan${e?"":" Belum"} Dibayarkan (Rp${b((S=t.value)==null?void 0:S.total_payment)})`,time:e==null?void 0:e.created_at,passed:((N=l.value)==null?void 0:N.status)!=="paid"&&e,active:((M=l.value)==null?void 0:M.status)==="paid",icon:Se},{title:"Sedang Dikemas",time:n==null?void 0:n.created_at,icon:Ne,passed:((X=l.value)==null?void 0:X.status)!=="on_processing"&&n,active:((A=l.value)==null?void 0:A.status)==="on_processing"},{title:"Dikirim",time:i==null?void 0:i.created_at,icon:Me,passed:((C=l.value)==null?void 0:C.status)!=="on_delivery"&&i,active:((V=l.value)==null?void 0:V.status)==="on_delivery"},{title:(E=(T=(O=t.value)==null?void 0:O.items)==null?void 0:T[0])!=null&&E.is_reviewed?"Selesai":"Belum Dinilai",time:(F=(z=(K=t.value)==null?void 0:K.items)==null?void 0:z[0])!=null&&F.is_reviewed?d==null?void 0:d.created_at:"",icon:Xe,passed:((L=l.value)==null?void 0:L.status)!=="done"&&d,active:((H=l.value)==null?void 0:H.status)==="done"}]}),ve=f(()=>{var a,e;return(e=(a=t.value)==null?void 0:a.status)==null?void 0:e.map((n,i,d)=>({title:n==null?void 0:n.description,time:n==null?void 0:n.created_at,active:i===d.length-1})).sort((n,i)=>new Date(i.time)-new Date(n.time))}),ye=f(()=>{var a,e,n,i,d,p,m,x,k;return[{label:"Subtotal Produk",value:`Rp ${b((a=t.value)==null?void 0:a.subtotal)}`},{label:"Subtotal Pengiriman",value:`Rp ${b((e=t.value)==null?void 0:e.courier_price)}`},{label:"Voucher Digunakan",value:`Rp ${b((n=t.value)==null?void 0:n.voucher_value)}`},{label:"Cashback Koin",value:`Rp ${b(((i=t.value)==null?void 0:i.voucher_cashback)||0)}`},{label:`${(d=t.value)==null?void 0:d.pay_with_coin} Koin Syopo ditukarkan`,value:`Rp ${b((p=t.value)==null?void 0:p.pay_with_coin)}`},{label:"Biaya Layanan",value:`Rp ${b((m=t.value)==null?void 0:m.service_fee)}`},{label:"Total Pesanan",value:`Rp ${b((x=t.value)==null?void 0:x.total_payment)}`,class:"text-primary text-2xl"},{label:"Metode Pembayaran",value:((k=t.value)==null?void 0:k.payment_method)==="bni_va"?"Virtual Account":"QRIS"}]}),{status:fe,execute:be}=Ke(f(()=>`/server/api/order/${g.params.orderId}/mark-done`),{onResponse({response:a}){a.ok&&Y()}});function xe(){window.confirm("Apa anda yakin untuk menyelesaikan order ini?")&&be()}function ke(){J.value.setDefaultData(t.value),U.value=!0}return(a,e)=>{var w,D,$,I,R,P,j,B,S,N,M,X,A,C,V,O,T,E,K,z,F,L,H,u,te,se,ae,oe,ne,ie,re,le;const n=he,i=Re,d=Pe,p=je,m=Ae,x=Ce,k=Ve;return o(pe)==="pending"?(c(),ue(n,{key:0})):(c(),v("div",Le,[s("div",He,[s("div",Ue,[y(i,{label:"Kembali",to:"/my-account/orders",icon:"i-heroicons:chevron-left",padded:!1,variant:"link",color:"gray"}),s("div",Qe,[s("span",qe,"NO. PESANAN. "+r((w=o(t))==null?void 0:w.invoice_number),1),s("span",Ge,r((D=o(l))==null?void 0:D.description),1)])]),s("div",Je,[y(d,{items:o(_e),class:"grid grid-cols-5"},null,8,["items"])]),(($=o(l))==null?void 0:$.status)==="pending_payment"?(c(),v("div",We,[y(i,{class:"min-w-56 justify-center",label:"Bayar",to:`/checkout/payment/${(I=o(t))==null?void 0:I.uuid}`},null,8,["to"])])):Q("",!0),((R=o(l))==null?void 0:R.status)==="on_delivery"?(c(),v("div",Ye,[s("p",Ze,[e[1]||(e[1]=h(" Produk diperkirakan akan sampai pada ",-1)),s("span",et,r(o(Z).start),1),e[2]||(e[2]=h(" - ",-1)),s("span",tt,r(o(Z).end),1)]),y(i,{class:"min-w-56 justify-center",label:"Pesanan Selesai",loading:o(fe)==="pending",onClick:xe},null,8,["loading"])])):Q("",!0),((P=o(l))==null?void 0:P.status)==="done"&&o(me)?(c(),v("div",st,[s("p",at,[e[3]||(e[3]=h(" Nilai pesanan sebelum ",-1)),s("span",ot,r(o(ee)),1),e[4]||(e[4]=h(" dan dapatkan maks. 25 Koin Syopo! ",-1))]),y(i,{class:"min-w-56 justify-center",label:"Nilai",onClick:ke})])):Q("",!0),s("div",nt,[s("div",it,[e[6]||(e[6]=s("p",{class:"text-xl"},"Alamat Pengiriman",-1)),s("div",rt,[s("p",lt,r((j=o(t))==null?void 0:j.courier)+" - "+r((B=o(t))==null?void 0:B.courier_type),1),e[5]||(e[5]=s("p",null,"XXXXXXXXX",-1))])]),s("div",dt,[s("div",ut,[s("p",null,r((N=(S=o(t))==null?void 0:S.address)==null?void 0:N.receiver_name),1),s("p",ct,r((X=(M=o(t))==null?void 0:M.address)==null?void 0:X.receiver_phone),1),s("p",pt,r((C=(A=o(t))==null?void 0:A.address)==null?void 0:C.detail_address)+" "+r((O=(V=o(t))==null?void 0:V.address)==null?void 0:O.district)+", "+r((K=(E=(T=o(t))==null?void 0:T.address)==null?void 0:E.city)==null?void 0:K.name)+", "+r((H=(L=(F=(z=o(t))==null?void 0:z.address)==null?void 0:F.city)==null?void 0:L.province)==null?void 0:H.name)+", "+r((te=(u=o(t))==null?void 0:u.address)==null?void 0:te.postal_code)+" "+r((ae=(se=o(t))==null?void 0:se.address)==null?void 0:ae.address_note),1)]),s("div",mt,[y(p,{items:o(ve)},null,8,["items"])])])])]),s("div",_t,[s("div",vt,[s("div",yt,[s("span",ft,r((ne=(oe=o(t))==null?void 0:oe.seller)==null?void 0:ne.store_name),1),y(i,{color:"white",size:"xs",to:`/shop/${(re=(ie=o(t))==null?void 0:ie.seller)==null?void 0:re.username}`},{default:$e(()=>[y(m),e[7]||(e[7]=h(" Kunjungi Toko ",-1))]),_:1},8,["to"])]),e[8]||(e[8]=s("hr",{class:"mt-3"},null,-1)),s("div",bt,[(c(!0),v(q,null,ce((le=o(t))==null?void 0:le.items,_=>(c(),ue(x,{key:`product-${_.uuid}`,size:"sm",class:"py-3",item:_},null,8,["item"]))),128))])]),s("div",null,[s("table",xt,[(c(!0),v(q,null,ce(o(ye),_=>(c(),v("tr",{key:_.label},[s("td",null,[_.label==="Metode Pembayaran"?(c(),v("div",kt,[e[9]||(e[9]=s("img",{src:Oe,class:"h-4 w-4"},null,-1)),s("span",null,r(_.label),1)])):(c(),v(q,{key:1},[h(r(_.label),1)],64))]),s("td",null,r(_.value),1)]))),128))])])]),y(k,{ref_key:"modalReviewElement",ref:J,open:o(U),"onUpdate:open":e[0]||(e[0]=_=>Ie(U)?U.value=_:null),onSuccess:o(Y)},null,8,["open","onSuccess"])]))}}},ns=ge(ht,[["__scopeId","data-v-f610349e"]]);export{ns as default};
